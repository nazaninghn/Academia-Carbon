{% extends 'dashboard_base.html' %}
{% load static %}
{% load i18n %}

{% block page_title %}Help & Support{% endblock %}

{% block extra_css %}
<style>
    .support-card {
        background: white;
        border: 1px solid #e5e7eb;
        border-radius: 12px;
        padding: 24px;
        margin-bottom: 20px;
        box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    .support-card h3 {
        font-size: 18px;
        font-weight: 700;
        color: #1e293b;
        margin-bottom: 12px;
        display: flex;
        align-items: center;
        gap: 10px;
    }
    
    .support-card p {
        color: #64748b;
        margin-bottom: 16px;
        line-height: 1.6;
    }
    
    .support-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
        gap: 20px;
        margin-bottom: 30px;
    }
    
    .support-option {
        display: flex;
        align-items: flex-start;
        gap: 15px;
        padding: 20px;
        background: #f8fafc;
        border-radius: 12px;
        border: 1px solid #e2e8f0;
        transition: all 0.3s;
        cursor: pointer;
    }
    
    .support-option:hover {
        background: #f1f5f9;
        border-color: #10b981;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    
    .support-icon {
        width: 48px;
        height: 48px;
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        border-radius: 12px;
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: 20px;
        flex-shrink: 0;
    }
    
    .support-content h4 {
        font-size: 16px;
        font-weight: 600;
        color: #1e293b;
        margin: 0 0 8px 0;
    }
    
    .support-content p {
        font-size: 14px;
        color: #64748b;
        margin: 0;
        line-height: 1.5;
    }
    
    .faq-item {
        border: 1px solid #e2e8f0;
        border-radius: 8px;
        margin-bottom: 10px;
        overflow: hidden;
    }
    
    .faq-question {
        padding: 16px 20px;
        background: #f8fafc;
        cursor: pointer;
        display: flex;
        justify-content: space-between;
        align-items: center;
        font-weight: 600;
        color: #1e293b;
        transition: all 0.3s;
    }
    
    .faq-question:hover {
        background: #f1f5f9;
    }
    
    .faq-answer {
        padding: 0 20px;
        max-height: 0;
        overflow: hidden;
        transition: all 0.3s;
        background: white;
    }
    
    .faq-answer.active {
        padding: 16px 20px;
        max-height: 200px;
    }
    
    .faq-answer p {
        margin: 0;
        color: #64748b;
        line-height: 1.6;
    }
    
    .contact-form {
        display: grid;
        gap: 20px;
    }
    
    .form-group {
        margin-bottom: 0;
    }
    
    .form-group label {
        display: block;
        font-size: 14px;
        font-weight: 600;
        color: #374151;
        margin-bottom: 8px;
    }
    
    .form-control {
        width: 100%;
        padding: 12px 16px;
        border: 1px solid #d1d5db;
        border-radius: 8px;
        font-size: 14px;
        transition: all 0.3s;
    }
    
    .form-control:focus {
        outline: none;
        border-color: #10b981;
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
    }
    
    .btn-primary {
        background: linear-gradient(135deg, #10b981 0%, #059669 100%);
        color: white;
        border: none;
        padding: 12px 24px;
        border-radius: 8px;
        font-weight: 600;
        text-decoration: none;
        display: inline-flex;
        align-items: center;
        gap: 8px;
        transition: all 0.3s;
        cursor: pointer;
    }
    
    .btn-primary:hover {
        background: linear-gradient(135deg, #059669 0%, #047857 100%);
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(16, 185, 129, 0.3);
        color: white;
    }
    
    .status-badge {
        padding: 4px 12px;
        border-radius: 20px;
        font-size: 12px;
        font-weight: 600;
    }
    
    .status-online {
        background: #dcfce7;
        color: #166534;
    }
    
    .status-busy {
        background: #fef3c7;
        color: #92400e;
    }
</style>
{% endblock %}

{% block header_actions %}
<!-- Support specific actions -->
<div style="display: flex; align-items: center; gap: 15px;">
    <div style="display: flex; align-items: center; gap: 8px;">
        <label style="font-size: 13px; font-weight: 600; color: #475569;">
            <i class="fas fa-headset" style="color: #22c55e;"></i> {% trans "Status" %}:
        </label>
        <span class="status-badge status-online">‚óè {% trans "Online" %}</span>
    </div>
    <button onclick="window.open('mailto:support@SustIndexcarbon.com', '_blank')" style="padding: 8px 16px; background: #10b981; color: white; border: none; border-radius: 6px; font-size: 13px; font-weight: 600; cursor: pointer;">
        <i class="fas fa-envelope"></i> {% trans "Email Support" %}
    </button>
</div>
{% endblock %}

{% block content %}
<!-- Professional Page Header -->
{% include 'partials/page_header.html' %}

<div class="container" style="max-width: 1200px; margin: 0 auto; padding: 0 20px;">
    <!-- Support Options -->
    <div class="support-grid">
        <div class="support-option" onclick="scrollToSection('contact-form')">
            <div class="support-icon">
                <i class="fas fa-envelope"></i>
            </div>
            <div class="support-content">
                <h4>{% trans "Contact Support" %}</h4>
                <p>{% trans "Send us a message and we'll get back to you within 24 hours during business days." %}</p>
            </div>
        </div>

        <div class="support-option" onclick="scrollToSection('faq-section')">
            <div class="support-icon">
                <i class="fas fa-question-circle"></i>
            </div>
            <div class="support-content">
                <h4>{% trans "Frequently Asked Questions" %}</h4>
                <p>{% trans "Find quick answers to common questions about using SustIndex." %}</p>
            </div>
        </div>

        <div class="support-option" onclick="window.open('mailto:support@SustIndexcarbon.com', '_blank')">
            <div class="support-icon">
                <i class="fas fa-phone"></i>
            </div>
            <div class="support-content">
                <h4>{% trans "Direct Contact" %}</h4>
                <p>{% trans "Email us directly at support@SustIndexcarbon.com for immediate assistance." %}</p>
            </div>
        </div>

        <div class="support-option" onclick="scrollToSection('resources')">
            <div class="support-icon">
                <i class="fas fa-book"></i>
            </div>
            <div class="support-content">
                <h4>{% trans "Documentation" %}</h4>
                <p>{% trans "Access comprehensive guides and documentation for all platform features." %}</p>
            </div>
        </div>
    </div>

    <!-- FAQ Section -->
    <div class="support-card" id="faq-section">
        <h3>
            <i class="fas fa-question-circle" style="color: #3b82f6;"></i>
            Frequently Asked Questions
        </h3>
        <p>Find answers to the most common questions about SustIndex.</p>
        
        <div class="faq-item">
            <div class="faq-question" onclick="toggleFaq(this)">
                How do I add emission data to my inventory?
                <i class="fas fa-chevron-down"></i>
            </div>
            <div class="faq-answer">
                <p>Navigate to the "Data Collection" page from the sidebar menu. Select the appropriate scope (1, 2, or 3), choose your emission category, fill in the required information including emission source, activity data, and units, then click "Calculate" to add the data to your inventory.</p>
            </div>
        </div>

        <div class="faq-item">
            <div class="faq-question" onclick="toggleFaq(this)">
                What emission factors does the system use?
                <i class="fas fa-chevron-down"></i>
            </div>
            <div class="faq-answer">
                <p>We use internationally recognized emission factors from sources including IPCC, Defra, EPA, and country-specific databases. For Turkey, we use factors from the Turkish Ministry of Environment and IEA. You can also add custom emission factors from your suppliers.</p>
            </div>
        </div>

        <div class="faq-item">
            <div class="faq-question" onclick="toggleFaq(this)">
                How do I generate an ISO 14064-1 compliant report?
                <i class="fas fa-chevron-down"></i>
            </div>
            <div class="faq-answer">
                <p>Go to the "Reporting" section and select "ISO 14064-1 Reporting". The system will automatically generate a compliant report based on your entered data. You can download it as a PDF or view it online. For enhanced accuracy, you can optionally share additional organizational details.</p>
            </div>
        </div>

        <div class="faq-item">
            <div class="faq-question" onclick="toggleFaq(this)">
                Can I add suppliers and track their emissions?
                <i class="fas fa-chevron-down"></i>
            </div>
            <div class="faq-answer">
                <p>Yes! When entering emission data, you can add new suppliers with detailed information including contact details, activity type, and location. This helps you track emissions by supplier and build a comprehensive supplier database for future engagement.</p>
            </div>
        </div>

        <div class="faq-item">
            <div class="faq-question" onclick="toggleFaq(this)">
                What if I can't find my industry type or material?
                <i class="fas fa-chevron-down"></i>
            </div>
            <div class="faq-answer">
                <p>You can request new industry types or materials directly from the system. Click "Add Industry" or select "Other" when choosing materials, then submit a request with details. Our team will research and add appropriate emission factors from official sources.</p>
            </div>
        </div>

        <div class="faq-item">
            <div class="faq-question" onclick="toggleFaq(this)">
                How secure is my data?
                <i class="fas fa-chevron-down"></i>
            </div>
            <div class="faq-answer">
                <p>Your data is stored securely using industry-standard encryption and security practices. We comply with data protection regulations and never share your emission data with third parties without your explicit consent. You can export or delete your data at any time from the Settings page.</p>
            </div>
        </div>
    </div>

    <!-- Contact Form -->
    <div class="support-card" id="contact-form">
        <h3>
            <i class="fas fa-envelope" style="color: #10b981;"></i>
            Contact Support Team
        </h3>
        <p>Can't find what you're looking for? Send us a message and we'll help you out.</p>
        
        <form class="contact-form" onsubmit="submitSupportForm(event)">
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div class="form-group">
                    <label>{% trans "Your Name" %}</label>
                    <input type="text" class="form-control" value="{{ user.first_name }} {{ user.last_name }}" required>
                </div>
                <div class="form-group">
                    <label>{% trans "Email Address" %}</label>
                    <input type="email" class="form-control" value="{{ user.email }}" required>
                </div>
            </div>
            
            <div class="form-group">
                <label>{% trans "Subject" %}</label>
                <select class="form-control" required>
                    <option value="">{% trans "Select a topic" %}</option>
                    <option value="data-entry">{% trans "Data Entry Help" %}</option>
                    <option value="reporting">{% trans "Reporting Issues" %}</option>
                    <option value="technical">{% trans "Technical Problems" %}</option>
                    <option value="account">{% trans "Account Management" %}</option>
                    <option value="feature-request">{% trans "Feature Request" %}</option>
                    <option value="other">{% trans "Other" %}</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Priority Level</label>
                <select class="form-control" required>
                    <option value="low">Low - General question</option>
                    <option value="medium" selected>Medium - Need help soon</option>
                    <option value="high">High - Blocking my work</option>
                    <option value="urgent">Urgent - System down</option>
                </select>
            </div>
            
            <div class="form-group">
                <label>Message</label>
                <textarea class="form-control" rows="6" placeholder="{% trans 'Please describe your issue or question in detail...' %}" required></textarea>
            </div>
            
            <button type="submit" class="btn-primary">
                <i class="fas fa-paper-plane"></i>
                Send Message
            </button>
        </form>
    </div>

    <!-- Resources -->
    <div class="support-card" id="resources">
        <h3>
            <i class="fas fa-book" style="color: #8b5cf6;"></i>
            Documentation & Resources
        </h3>
        <p>Access comprehensive guides and resources to help you make the most of SustIndex.</p>
        
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px;">
            <div style="padding: 16px; background: #f8fafc; border-radius: 8px; border: 1px solid #e2e8f0;">
                <h4 style="margin: 0 0 8px 0; color: #1e293b; font-size: 16px;">
                    <i class="fas fa-play-circle" style="color: #10b981; margin-right: 8px;"></i>
                    Getting Started Guide
                </h4>
                <p style="margin: 0; color: #64748b; font-size: 14px;">Step-by-step tutorial for new users</p>
            </div>
            
            <div style="padding: 16px; background: #f8fafc; border-radius: 8px; border: 1px solid #e2e8f0;">
                <h4 style="margin: 0 0 8px 0; color: #1e293b; font-size: 16px;">
                    <i class="fas fa-database" style="color: #3b82f6; margin-right: 8px;"></i>
                    Data Entry Manual
                </h4>
                <p style="margin: 0; color: #64748b; font-size: 14px;">Complete guide to emission data collection</p>
            </div>
            
            <div style="padding: 16px; background: #f8fafc; border-radius: 8px; border: 1px solid #e2e8f0;">
                <h4 style="margin: 0 0 8px 0; color: #1e293b; font-size: 16px;">
                    <i class="fas fa-file-alt" style="color: #f59e0b; margin-right: 8px;"></i>
                    Reporting Standards
                </h4>
                <p style="margin: 0; color: #64748b; font-size: 14px;">ISO 14064-1 compliance guidelines</p>
            </div>
            
            <div style="padding: 16px; background: #f8fafc; border-radius: 8px; border: 1px solid #e2e8f0;">
                <h4 style="margin: 0 0 8px 0; color: #1e293b; font-size: 16px;">
                    <i class="fas fa-video" style="color: #ef4444; margin-right: 8px;"></i>
                    Video Tutorials
                </h4>
                <p style="margin: 0; color: #64748b; font-size: 14px;">Watch and learn with video guides</p>
            </div>
        </div>
    </div>

    <!-- Contact Information -->
    <div class="support-card">
        <h3>
            <i class="fas fa-headset" style="color: #64748b;"></i>
            Contact Information
        </h3>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 20px;">
            <div style="text-align: center;">
                <div style="font-size: 18px; font-weight: 600; color: #1e293b; margin-bottom: 4px;">Email Support</div>
                <div style="color: #10b981; font-weight: 500;">support@SustIndexcarbon.com</div>
                <div style="font-size: 12px; color: #64748b; margin-top: 4px;">Response within 24 hours</div>
            </div>
            <div style="text-align: center;">
                <div style="font-size: 18px; font-weight: 600; color: #1e293b; margin-bottom: 4px;">Business Hours</div>
                <div style="color: #64748b;">Monday - Friday</div>
                <div style="color: #64748b;">9:00 AM - 6:00 PM (GMT+3)</div>
            </div>
            <div style="text-align: center;">
                <div style="font-size: 18px; font-weight: 600; color: #1e293b; margin-bottom: 4px;">Emergency Support</div>
                <div style="color: #ef4444; font-weight: 500;">For system outages only</div>
                <div style="font-size: 12px; color: #64748b; margin-top: 4px;">Available 24/7</div>
            </div>
        </div>
    </div>
</div>

<script>
function toggleFaq(element) {
    const answer = element.nextElementSibling;
    const icon = element.querySelector('i');
    
    // Close all other FAQs
    document.querySelectorAll('.faq-answer').forEach(item => {
        if (item !== answer) {
            item.classList.remove('active');
        }
    });
    
    document.querySelectorAll('.faq-question i').forEach(item => {
        if (item !== icon) {
            item.style.transform = 'rotate(0deg)';
        }
    });
    
    // Toggle current FAQ
    answer.classList.toggle('active');
    
    if (answer.classList.contains('active')) {
        icon.style.transform = 'rotate(180deg)';
    } else {
        icon.style.transform = 'rotate(0deg)';
    }
}

function scrollToSection(sectionId) {
    document.getElementById(sectionId).scrollIntoView({ 
        behavior: 'smooth',
        block: 'start'
    });
}

function submitSupportForm(event) {
    event.preventDefault();
    
    // Show success message
    const successMsg = document.createElement('div');
    successMsg.style.cssText = 'position: fixed; top: 20px; right: 20px; background: #10b981; color: white; padding: 15px 25px; border-radius: 8px; z-index: 10000; box-shadow: 0 4px 12px rgba(0,0,0,0.15);';
    successMsg.innerHTML = '<i class="fas fa-check-circle"></i> Message sent successfully! We\'ll get back to you within 24 hours.';
    document.body.appendChild(successMsg);
    
    // Clear form
    event.target.reset();
    
    setTimeout(() => {
        successMsg.remove();
    }, 5000);
}
</script>
{% endblock %}
